# Generated by Django 5.2 on 2025-05-24 06:00

import adminPanel.models
import django.db.models.deletion
import django.utils.timezone
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='CommissioningProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('commission_percentage', models.DecimalField(decimal_places=2, max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='EmailSetting',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('user_registration_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='User Registration (From)')),
                ('user_registration_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='User Registration (To)')),
                ('account_approval_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Account Approval (From)')),
                ('account_rejection_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Account Rejection (From)')),
                ('trading_account_opening_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Trading Account Opening (From)')),
                ('trading_account_opening_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Trading Account Opening (To)')),
                ('demo_account_welcome_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Demo Account Welcome (From)')),
                ('demo_account_welcome_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Demo Account Notification (To)')),
                ('mam_manager_notification_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='MAM Manager Notification (From)')),
                ('mam_investor_notification_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='MAM Investor Notification (From)')),
                ('prop_trading_notification_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Proprietary Trading Notification (From)')),
                ('prop_trading_notification_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Proprietary Trading Notification (To)')),
                ('deposit_notification_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Deposit Notification (From)')),
                ('deposit_notification_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Deposit Notification (To)')),
                ('withdrawal_notification_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Withdrawal Notification (From)')),
                ('withdrawal_notification_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Withdrawal Notification (To)')),
                ('internal_transfer_notification_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Internal Transfer Notification (From)')),
                ('internal_transfer_notification_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Internal Transfer Notification (To)')),
                ('promotional_email_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Promotional Email (From)')),
                ('sales_inquiry_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Sales Inquiry (From)')),
                ('sales_inquiry_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Sales Inquiry (To)')),
                ('daily_report_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Daily Report (From)')),
                ('daily_report_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Daily Report (To)')),
                ('trading_performance_report_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Trading Performance Report (From)')),
                ('support_ticket_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Support Ticket (From)')),
                ('support_ticket_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Support Ticket (To)')),
                ('back_office_notification_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Back Office Notification (To)')),
                ('compliance_notification_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Compliance Notification (To)')),
                ('risk_management_to', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Risk Management Notification (To)')),
                ('no_reply_from', models.EmailField(blank=True, max_length=254, null=True, verbose_name='No-Reply Notification (From)')),
                ('master_password', models.CharField(blank=True, help_text='Master password for all the emails.', max_length=255, null=True, verbose_name='Master Password')),
            ],
            options={
                'verbose_name': 'Email Setting',
                'verbose_name_plural': 'Email Settings',
            },
        ),
        migrations.CreateModel(
            name='Package',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('bonus_fund', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('price', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('total_tradable_fund', models.DecimalField(decimal_places=2, default=Decimal('0.00'), editable=False, max_digits=12)),
                ('leverage', models.PositiveIntegerField(default=1)),
                ('max_cutoff', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('target', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12)),
                ('target_time_in_days', models.PositiveIntegerField(default=30)),
                ('profit_share', models.PositiveIntegerField(default=0)),
                ('enabled', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='CustomUser',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('user_id', models.PositiveIntegerField(editable=False, null=True, unique=True)),
                ('first_name', models.CharField(max_length=50)),
                ('last_name', models.CharField(max_length=50)),
                ('dob', models.DateField(blank=True, null=True)),
                ('phone_number', models.CharField(blank=True, max_length=15)),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('username', models.CharField(editable=False, max_length=101)),
                ('role', models.CharField(choices=[('admin', 'Admin'), ('manager', 'Manager'), ('client', 'Client')], default='client', max_length=10)),
                ('address', models.CharField(blank=True, max_length=255)),
                ('city', models.CharField(blank=True, max_length=100)),
                ('zip_code', models.CharField(blank=True, max_length=10)),
                ('state', models.CharField(blank=True, max_length=100)),
                ('country', models.CharField(blank=True, max_length=100)),
                ('profile_pic', models.URLField(blank=True, null=True)),
                ('id_proof', models.FileField(blank=True, help_text='ID Proof file', null=True, upload_to=adminPanel.models.CustomUser.id_file)),
                ('address_proof', models.FileField(blank=True, help_text='Address Proof file', null=True, upload_to=adminPanel.models.CustomUser.address_file)),
                ('address_proof_verified', models.BooleanField(default=False)),
                ('id_proof_verified', models.BooleanField(default=False)),
                ('IB_status', models.BooleanField(default=False)),
                ('MAM_manager_status', models.BooleanField(default=False)),
                ('otp', models.CharField(blank=True, max_length=6, null=True)),
                ('otp_created_at', models.DateTimeField(blank=True, null=True)),
                ('manager_admin_status', models.CharField(choices=[('None', 'None'), ('Admin Level 1', 'Admin Level 1'), ('Admin Level 2', 'Admin Level 2'), ('Manager Level 1', 'Manager Level 1'), ('Manager Level 2', 'Manager Level 2'), ('Manager Level 3', 'Manager Level 3')], default='None', max_length=20)),
                ('date_joined', models.DateTimeField(default=django.utils.timezone.now)),
                ('is_active', models.BooleanField(default=True)),
                ('is_staff', models.BooleanField(default=False)),
                ('created_by', models.ForeignKey(blank=True, help_text='The user who created this account. Default is None if self-signup.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_users', to=settings.AUTH_USER_MODEL)),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to.', related_name='custom_user_set', to='auth.group', verbose_name='groups')),
                ('parent_ib', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='clients', to=settings.AUTH_USER_MODEL)),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='custom_user_set', to='auth.permission', verbose_name='user permissions')),
                ('commissioning_profile', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ib_users', to='adminPanel.commissioningprofile')),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='ActivityLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('activity', models.TextField()),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('ip_address', models.CharField(blank=True, max_length=100, null=True)),
                ('activity_type', models.CharField(choices=[('create', 'Create'), ('update', 'Update'), ('delete', 'Delete')], default='create', max_length=10)),
                ('activity_category', models.CharField(choices=[('client', 'Client'), ('management', 'Management')], default='client', max_length=10)),
                ('endpoint', models.CharField(blank=True, max_length=255, null=True)),
                ('user_agent', models.CharField(blank=True, max_length=255, null=True)),
                ('related_object_id', models.PositiveIntegerField(blank=True, null=True)),
                ('related_object_type', models.CharField(blank=True, max_length=50, null=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='BankDetails',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('bank_name', models.CharField(max_length=255)),
                ('account_number', models.CharField(max_length=20)),
                ('branch', models.CharField(max_length=255)),
                ('ifsc_code', models.CharField(max_length=11)),
                ('bank_doc', models.FileField(blank=True, null=True, upload_to='documents/bank_docs/')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='bank_details', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='BankDetailsRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('bank_name', models.CharField(max_length=255)),
                ('account_number', models.CharField(max_length=20)),
                ('branch', models.CharField(max_length=255)),
                ('ifsc_code', models.CharField(max_length=11)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected')], default='PENDING', max_length=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bank_detail_requests', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='CryptoDetails',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('wallet_address', models.CharField(max_length=255)),
                ('exchange_name', models.CharField(max_length=255)),
                ('crypto_doc', models.FileField(blank=True, null=True, upload_to='documents/crypto_docs/')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='crypto_details', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='DemoAccount',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('account_name', models.CharField(blank=True, default='', max_length=255)),
                ('account_id', models.CharField(default=uuid.uuid4, max_length=100, unique=True)),
                ('leverage', models.CharField(default='100', max_length=20)),
                ('balance', models.DecimalField(decimal_places=2, default=Decimal('10000.00'), max_digits=12)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('is_enabled', models.BooleanField(default=True)),
                ('is_algo_enabled', models.BooleanField(default=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='demo_accounts', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='IBRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('approved', 'Approved'), ('rejected', 'Rejected')], default='pending', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='ib_request', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='Ticket',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('subject', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('status', models.CharField(choices=[('open', 'Open'), ('pending', 'Pending'), ('closed', 'Closed')], default='open', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('closed_at', models.DateTimeField(blank=True, null=True)),
                ('reopened_at', models.DateTimeField(blank=True, null=True)),
                ('closed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='closed_tickets', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='created_tickets', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='Message',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('content', models.TextField(blank=True, null=True)),
                ('file', models.FileField(blank=True, null=True, upload_to='messages/')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('sender', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages_sent', to=settings.AUTH_USER_MODEL)),
                ('ticket', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='adminPanel.ticket')),
            ],
        ),
        migrations.CreateModel(
            name='TicketStatusLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(max_length=20)),
                ('changed_at', models.DateTimeField(auto_now_add=True)),
                ('changed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('ticket', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='status_logs', to='adminPanel.ticket')),
            ],
        ),
        migrations.CreateModel(
            name='TradingAccount',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('account_id', models.CharField(help_text='Unique identifier for the trading account.', max_length=100, unique=True)),
                ('account_type', models.CharField(choices=[('standard', 'Standard Trading Account'), ('mam', 'MAM Master Account'), ('mam_investment', 'MAM Investment Account'), ('prop', 'Proprietary Trading Account')], default='standard', help_text='Type of the trading account.', max_length=20)),
                ('account_name', models.CharField(blank=True, default='', help_text='Name of the trading account.', max_length=255)),
                ('leverage', models.PositiveIntegerField(default=100, help_text='Leverage value (integer only).')),
                ('balance', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Current balance of the trading account.', max_digits=12)),
                ('is_enabled', models.BooleanField(default=True, help_text='Whether the account is enabled.')),
                ('is_trading_enabled', models.BooleanField(default=True, help_text='Whether trading is enabled for this account.')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the account was created.')),
                ('group_name', models.CharField(blank=True, help_text='Trading group name, if applicable.', max_length=255, null=True)),
                ('manager_allow_copy', models.BooleanField(default=True, help_text='Indicates if the manager allows copying.')),
                ('investor_allow_copy', models.BooleanField(default=True, help_text='Indicates if the investor allows copying.')),
                ('profit_sharing_percentage', models.DecimalField(blank=True, decimal_places=2, help_text='Profit sharing percentage (for MAM master accounts).', max_digits=5, null=True)),
                ('risk_level', models.CharField(blank=True, choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High')], help_text='Risk level (for MAM master accounts).', max_length=10, null=True)),
                ('is_algo_enabled', models.BooleanField(default=False, help_text='Indicates whether algorithmic trading is enabled (for MAM).')),
                ('payout_frequency', models.CharField(blank=True, choices=[('weekly', 'Weekly'), ('monthly', 'Monthly'), ('quarterly', 'Quarterly'), ('half-yearly', 'Half-Yearly')], help_text='Frequency of profit payouts (for MAM master accounts).', max_length=20, null=True)),
                ('status', models.CharField(blank=True, choices=[('running', 'Running'), ('success', 'Success'), ('failed', 'Failed')], default='running', help_text='Current status of the proprietary trading account.', max_length=20, null=True)),
                ('approved_at', models.DateTimeField(blank=True, help_text='Timestamp when the account was approved.', null=True)),
                ('start_date', models.DateTimeField(blank=True, help_text='The start date of trading for this proprietary account.', null=True)),
                ('end_date', models.DateTimeField(blank=True, help_text='The end date of trading for this proprietary account.', null=True)),
                ('approved_by', models.ForeignKey(blank=True, help_text='Admin or manager who approved this account.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_prop_accounts', to=settings.AUTH_USER_MODEL)),
                ('mam_master_account', models.ForeignKey(blank=True, help_text='Link to the MAM master account (for investment accounts).', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='investments', to='adminPanel.tradingaccount')),
                ('package', models.ForeignKey(blank=True, help_text='The package associated with this proprietary trading account.', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='prop_trading_accounts', to='adminPanel.package')),
                ('user', models.ForeignKey(help_text='The user who owns this trading account.', on_delete=django.db.models.deletion.CASCADE, related_name='trading_accounts', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='PropTradingRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('user_name', models.CharField(default='', editable=False, max_length=150)),
                ('user_email', models.EmailField(default='', editable=False, max_length=254)),
                ('package_name', models.CharField(default='', editable=False, max_length=150)),
                ('package_details', models.TextField(default='', editable=False)),
                ('proof_of_payment', models.FileField(help_text='Proof of payment document uploaded by the user.', upload_to=adminPanel.models.PropTradingRequest.proof_of_payment_file)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('approved', 'Approved'), ('rejected', 'Rejected')], default='pending', help_text='The current status of the proprietary trading request.', max_length=10)),
                ('handled_by', models.CharField(default='', editable=False, max_length=255)),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='The timestamp when the request was created.')),
                ('handled_at', models.DateTimeField(blank=True, help_text='The timestamp when the request was handled.', null=True)),
                ('package', models.ForeignKey(help_text='The package associated with this proprietary trading request.', on_delete=django.db.models.deletion.CASCADE, related_name='prop_trading_requests', to='adminPanel.package')),
                ('user', models.ForeignKey(help_text='The user who is making the request.', on_delete=django.db.models.deletion.CASCADE, related_name='prop_trading_requests', to=settings.AUTH_USER_MODEL)),
                ('trading_account', models.OneToOneField(blank=True, help_text='The trading account created after approval of this request.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='prop_trading_request', to='adminPanel.tradingaccount')),
            ],
            options={
                'verbose_name': 'Proprietary Trading Request',
                'verbose_name_plural': 'Proprietary Trading Requests',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CommissionTransaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('ib_level', models.PositiveIntegerField()),
                ('total_commission', models.DecimalField(decimal_places=2, max_digits=12)),
                ('commission_to_ib', models.DecimalField(decimal_places=2, max_digits=12)),
                ('position_id', models.CharField(max_length=100)),
                ('position_type', models.CharField(default='buy', max_length=100)),
                ('position_symbol', models.CharField(default='', max_length=100)),
                ('position_direction', models.CharField(default='in', max_length=100)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('client_user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='commission_transactions_as_client', to=settings.AUTH_USER_MODEL)),
                ('ib_user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='commission_transactions_as_ib', to=settings.AUTH_USER_MODEL)),
                ('client_trading_account', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='commission_transactions', to='adminPanel.tradingaccount')),
            ],
        ),
        migrations.CreateModel(
            name='TradingAccountGroup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('available_groups', models.JSONField(default=list, editable=False, help_text='List of available groups fetched dynamically.')),
                ('approved_groups', models.JSONField(blank=True, default=list, help_text='List of approved groups for trading accounts.')),
                ('default_group', models.CharField(blank=True, help_text='The default group for trading accounts.', max_length=255, null=True)),
                ('demo_account_group', models.CharField(blank=True, help_text='The group used for demo trading accounts.', max_length=255, null=True)),
                ('created_at', models.DateTimeField(auto_now=True, help_text='Timestamp when the record was created.')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_groups', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='Transaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('source', models.CharField(blank=True, help_text="The origin or source of the transaction (e.g., 'Bank', 'Crypto', 'Internal').", max_length=100, null=True)),
                ('transaction_type', models.CharField(choices=[('deposit_trading', 'Deposit into Trading Account'), ('withdraw_trading', 'Withdrawal from Trading Account'), ('credit_in', 'Credit In into Trading Account'), ('credit_out', 'Credit Out from Trading Account'), ('commission_withdrawal', 'Commission Withdrawal'), ('internal_transfer', 'Internal Transfer Between Trading Accounts')], help_text='Type of transaction.', max_length=30)),
                ('amount', models.DecimalField(decimal_places=2, help_text='Amount involved in the transaction.', max_digits=12)),
                ('description', models.TextField(blank=True, help_text='Description or notes for the transaction.', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='When the transaction was created.')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('approved', 'Approved'), ('rejected', 'Rejected')], default='pending', help_text='Transaction status.', max_length=10)),
                ('approved_at', models.DateTimeField(blank=True, help_text='Timestamp when the transaction was approved/rejected.', null=True)),
                ('payout_to', models.CharField(blank=True, choices=[('bank', 'Bank'), ('crypto', 'Crypto')], help_text='Payout destination type (external payouts only).', max_length=50, null=True)),
                ('external_account', models.CharField(blank=True, help_text='Bank or crypto account details for the external payout.', max_length=255, null=True)),
                ('document', models.FileField(blank=True, help_text='Optional document (image or PDF) related to the transaction.', null=True, upload_to=adminPanel.models.Transaction.document_file)),
                ('approved_by', models.ForeignKey(blank=True, help_text='Admin who approved/rejected this transaction.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_transactions', to=settings.AUTH_USER_MODEL)),
                ('from_account', models.ForeignKey(blank=True, help_text='Source trading account for internal transfers.', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='outgoing_transfers', to='adminPanel.tradingaccount')),
                ('to_account', models.ForeignKey(blank=True, help_text='Destination trading account for internal transfers.', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='incoming_transfers', to='adminPanel.tradingaccount')),
                ('trading_account', models.ForeignKey(blank=True, help_text='Trading account involved in the transaction, if applicable.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='transactions', to='adminPanel.tradingaccount')),
                ('user', models.ForeignKey(help_text='User associated with the transaction.', on_delete=django.db.models.deletion.CASCADE, related_name='transactions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ChangeRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('requested_data', models.JSONField(help_text='Details of the changes requested')),
                ('id_proof', models.FileField(blank=True, help_text='ID proof file (image or PDF, max 1MB)', null=True, upload_to=adminPanel.models.ChangeRequest.id_file)),
                ('address_proof', models.FileField(blank=True, help_text='Address proof file (image or PDF, max 1MB)', null=True, upload_to=adminPanel.models.ChangeRequest.address_file)),
                ('status', models.CharField(choices=[('PENDING', 'Pending Approval'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected')], default='PENDING', max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('reviewed_at', models.DateTimeField(blank=True, null=True)),
                ('user', models.ForeignKey(help_text='Each user can have only one pending change request.', on_delete=django.db.models.deletion.CASCADE, related_name='change_requests', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'constraints': [models.UniqueConstraint(condition=models.Q(('status', 'PENDING')), fields=('user',), name='unique_pending_request_per_user')],
            },
        ),
    ]
